---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r setoptions, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Load up all dependencies and set global variables
library(knitr)
library(dplyr)
library(xtable)
library(datasets)
library(ggplot2)

opts_chunk$set(message=FALSE, warning=FALSE)
```
## Loading and preprocessing the data

```{r data, results='asis'}
df <- tbl_df(read.csv(unz("activity.zip","activity.csv")))
df$date <- as.Date.factor(df$date)
print(xtable(head(df)), type = 'html')
```

## What is mean total number of steps taken per day?
#### Apply 'sum' to each unique 'date' entry in the dataset
```{r sum}
sums <- tapply(df$steps, df$date, sum, na.rm = TRUE)
bwd <- 1200
```
#### Plot a histogram showing the frequency distribution of the number of steps per day
```{r plotsum}
data_frame(val = sums[sums > 0]) %>% ggplot(.,aes(sums[sums > 0]),)+geom_histogram(binwidth = bwd)+ geom_density(aes(y = bwd*..count..), linetype = "dashed")+xlab("Number of Steps per day")+geom_vline(xintercept = mean(sums), linetype = "dashed", col = "red")+geom_vline(xintercept = median(sums), linetype = "dashed", col = "blue")

print(summary(sums)[3:4])
```
## What is the average daily activity pattern?
#### Apply 'mean' to each unique 'interval' entry in the dataset
```{r compmean}
avg_steps <- tapply(df$steps, as.factor(df$interval), mean, na.rm = TRUE)
```
#### Plot a time series showing ```Average Number of Steps ~ Interval of the Day```
```{r tseries}
means <- tbl_df(cbind(avg_steps[avg_steps >0],df$interval[avg_steps > 0]))
names(means) <- c("avg_steps", "interval")
means %>% ggplot(.,aes(y =avg_steps, x=interval))+geom_line(ch = 4)+geom_smooth(col = "red", linetype = "dashed")
```

## Imputing missing values
```{r imputing}

```
## Are there differences in activity patterns between weekdays and weekends?
